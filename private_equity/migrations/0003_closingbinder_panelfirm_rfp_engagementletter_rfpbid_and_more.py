# Generated by Django 5.2.9 on 2025-12-29 14:49

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('core', '0008_file_extension'),
        ('custom_authentication', '0001_initial'),
        ('private_equity', '0002_clauselibrary_closingchecklist_dealvelocitymetrics_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ClosingBinder',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('format', models.CharField(choices=[('pdf', 'PDF'), ('zip', 'ZIP'), ('both', 'Both PDF and ZIP')], default='pdf', max_length=10)),
                ('include_toc', models.BooleanField(default=True)),
                ('include_signature_pages', models.BooleanField(default=True)),
                ('status', models.CharField(choices=[('generating', 'Generating'), ('completed', 'Completed'), ('failed', 'Failed')], default='generating', max_length=20)),
                ('table_of_contents', models.JSONField(default=list, help_text='Table of contents structure')),
                ('error_message', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pe_closing_binders', to='custom_authentication.client')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_created_binders', to=settings.AUTH_USER_MODEL)),
                ('due_diligence_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='closing_binders', to='private_equity.duediligencerun')),
                ('included_documents', models.ManyToManyField(blank=True, related_name='pe_included_in_binders', to='core.file')),
                ('pdf_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_binder_pdfs', to='core.file')),
                ('zip_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_binder_zips', to='core.file')),
            ],
            options={
                'db_table': 'private_equity_closing_binder',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='PanelFirm',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('practice_areas', models.JSONField(default=list, help_text='List of practice areas')),
                ('regions', models.JSONField(default=list, help_text='List of regions covered')),
                ('primary_contact_name', models.CharField(blank=True, max_length=255)),
                ('primary_contact_email', models.EmailField(blank=True, max_length=254)),
                ('primary_contact_phone', models.CharField(blank=True, max_length=50)),
                ('standard_hourly_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('discounted_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('billing_arrangements', models.JSONField(default=list, help_text='Accepted billing arrangements')),
                ('total_deals', models.IntegerField(default=0)),
                ('avg_deal_value', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('avg_rating', models.DecimalField(blank=True, decimal_places=2, max_digits=3, null=True)),
                ('on_time_delivery_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('is_preferred', models.BooleanField(default=False)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pe_panel_firms', to='custom_authentication.client')),
            ],
            options={
                'db_table': 'private_equity_panel_firm',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='RFP',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=500)),
                ('matter_type', models.CharField(choices=[('acquisition', 'Acquisition'), ('divestiture', 'Divestiture'), ('financing', 'Financing'), ('restructuring', 'Restructuring'), ('general_corporate', 'General Corporate')], max_length=50)),
                ('description', models.TextField(blank=True)),
                ('scope_of_work', models.TextField(blank=True)),
                ('estimated_value', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('requirements', models.JSONField(default=list, help_text='List of requirements')),
                ('response_deadline', models.DateTimeField()),
                ('project_start_date', models.DateField(blank=True, null=True)),
                ('project_end_date', models.DateField(blank=True, null=True)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('open', 'Open'), ('closed', 'Closed'), ('awarded', 'Awarded'), ('cancelled', 'Cancelled')], default='draft', max_length=20)),
                ('winning_bid_amount', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pe_rfps', to='custom_authentication.client')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_created_rfps', to=settings.AUTH_USER_MODEL)),
                ('due_diligence_run', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='rfps', to='private_equity.duediligencerun')),
                ('invited_firms', models.ManyToManyField(blank=True, related_name='invited_rfps', to='private_equity.panelfirm')),
                ('winning_firm', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='won_rfps', to='private_equity.panelfirm')),
            ],
            options={
                'db_table': 'private_equity_rfp',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='EngagementLetter',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('scope_description', models.TextField()),
                ('fee_arrangement', models.CharField(choices=[('hourly', 'Hourly Rates'), ('fixed', 'Fixed Fee'), ('capped', 'Capped Fee'), ('success', 'Success Fee'), ('hybrid', 'Hybrid')], max_length=20)),
                ('agreed_fee', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('fee_cap', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('engagement_start_date', models.DateField(blank=True, null=True)),
                ('estimated_completion_date', models.DateField(blank=True, null=True)),
                ('billing_frequency', models.CharField(blank=True, max_length=50)),
                ('payment_terms', models.CharField(blank=True, max_length=100)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('sent', 'Sent'), ('under_review', 'Under Review'), ('signed', 'Signed'), ('active', 'Active'), ('completed', 'Completed'), ('terminated', 'Terminated')], default='draft', max_length=30)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pe_engagement_letters', to='custom_authentication.client')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_created_engagement_letters', to=settings.AUTH_USER_MODEL)),
                ('due_diligence_run', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='engagement_letters', to='private_equity.duediligencerun')),
                ('generated_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_engagement_letter_docs', to='core.file')),
                ('signed_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_signed_engagement_letters', to='core.file')),
                ('firm', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='engagement_letters', to='private_equity.panelfirm')),
                ('rfp', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='engagement_letters', to='private_equity.rfp')),
            ],
            options={
                'db_table': 'private_equity_engagement_letter',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RFPBid',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('proposed_fee', models.DecimalField(decimal_places=2, max_digits=15)),
                ('fee_structure', models.CharField(choices=[('fixed', 'Fixed Fee'), ('hourly', 'Hourly'), ('capped', 'Capped'), ('success', 'Success Fee'), ('hybrid', 'Hybrid')], max_length=50)),
                ('proposed_timeline', models.TextField(blank=True)),
                ('team_composition', models.JSONField(default=list, help_text='Proposed team members')),
                ('price_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('experience_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('team_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('timeline_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('overall_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('is_selected', models.BooleanField(default=False)),
                ('rejection_reason', models.TextField(blank=True)),
                ('submitted_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pe_rfp_bids', to='custom_authentication.client')),
                ('firm', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bids', to='private_equity.panelfirm')),
                ('proposal_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_rfp_proposals', to='core.file')),
                ('rfp', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bids', to='private_equity.rfp')),
            ],
            options={
                'db_table': 'private_equity_rfp_bid',
                'ordering': ['-overall_score', 'proposed_fee'],
            },
        ),
        migrations.CreateModel(
            name='SignatureTracker',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('document_name', models.CharField(max_length=500)),
                ('signatory_name', models.CharField(max_length=255)),
                ('signatory_email', models.EmailField(blank=True, max_length=254)),
                ('signatory_role', models.CharField(blank=True, max_length=100)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('sent', 'Sent for Signature'), ('viewed', 'Viewed'), ('signed', 'Signed'), ('declined', 'Declined'), ('expired', 'Expired')], default='pending', max_length=20)),
                ('esign_provider', models.CharField(choices=[('docusign', 'DocuSign'), ('adobe_sign', 'Adobe Sign'), ('manual', 'Manual')], default='manual', max_length=20)),
                ('esign_envelope_id', models.CharField(blank=True, help_text='External e-sign envelope ID', max_length=255)),
                ('sent_at', models.DateTimeField(blank=True, null=True)),
                ('viewed_at', models.DateTimeField(blank=True, null=True)),
                ('signed_at', models.DateTimeField(blank=True, null=True)),
                ('due_date', models.DateField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pe_signature_trackers', to='custom_authentication.client')),
                ('document_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_signature_documents', to='core.file')),
                ('due_diligence_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='signature_trackers', to='private_equity.duediligencerun')),
                ('signed_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_signed_documents', to='core.file')),
            ],
            options={
                'db_table': 'private_equity_signature_tracker',
                'ordering': ['status', 'due_date'],
            },
        ),
        migrations.CreateModel(
            name='ConditionPrecedent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=500)),
                ('description', models.TextField(blank=True)),
                ('category', models.CharField(choices=[('regulatory', 'Regulatory Approval'), ('consent', 'Third-Party Consent'), ('financing', 'Financing'), ('legal', 'Legal/Corporate'), ('due_diligence', 'Due Diligence'), ('other', 'Other')], default='legal', max_length=50)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_progress', 'In Progress'), ('satisfied', 'Satisfied'), ('waived', 'Waived'), ('blocked', 'Blocked')], default='pending', max_length=20)),
                ('responsible_party', models.CharField(blank=True, max_length=255)),
                ('target_date', models.DateField(blank=True, null=True)),
                ('satisfied_date', models.DateField(blank=True, null=True)),
                ('blocker_description', models.TextField(blank=True)),
                ('blocker_resolution_plan', models.TextField(blank=True)),
                ('order', models.IntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_assigned_cps', to=settings.AUTH_USER_MODEL)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pe_conditions_precedent', to='custom_authentication.client')),
                ('due_diligence_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='conditions_precedent', to='private_equity.duediligencerun')),
                ('evidence_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_cp_evidence', to='core.file')),
            ],
            options={
                'db_table': 'private_equity_condition_precedent',
                'ordering': ['order', 'target_date'],
                'indexes': [models.Index(fields=['client', 'due_diligence_run', 'status'], name='private_equ_client__ed201d_idx')],
            },
        ),
        migrations.CreateModel(
            name='ConsentFiling',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=500)),
                ('filing_type', models.CharField(choices=[('hsr', 'HSR/Antitrust'), ('sec', 'SEC Filing'), ('state', 'State Filing'), ('consent', 'Third-Party Consent'), ('notice', 'Notice Requirement'), ('regulatory', 'Regulatory Approval')], max_length=30)),
                ('description', models.TextField(blank=True)),
                ('filing_party', models.CharField(blank=True, max_length=255)),
                ('receiving_party', models.CharField(blank=True, help_text='e.g., FTC, State AG, etc.', max_length=255)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('submitted', 'Submitted'), ('under_review', 'Under Review'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('withdrawn', 'Withdrawn')], default='pending', max_length=20)),
                ('due_date', models.DateField(blank=True, null=True)),
                ('submitted_date', models.DateField(blank=True, null=True)),
                ('approved_date', models.DateField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('rejection_reason', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approval_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_approval_documents', to='core.file')),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_assigned_filings', to=settings.AUTH_USER_MODEL)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pe_consent_filings', to='custom_authentication.client')),
                ('due_diligence_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='consent_filings', to='private_equity.duediligencerun')),
                ('filing_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_filing_documents', to='core.file')),
            ],
            options={
                'db_table': 'private_equity_consent_filing',
                'ordering': ['due_date', 'status'],
                'indexes': [models.Index(fields=['client', 'status'], name='private_equ_client__30f8d8_idx'), models.Index(fields=['due_date'], name='private_equ_due_dat_7b743e_idx'), models.Index(fields=['filing_type'], name='private_equ_filing__2d8fcb_idx')],
            },
        ),
        migrations.CreateModel(
            name='Covenant',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=500)),
                ('covenant_type', models.CharField(choices=[('financial', 'Financial Covenant'), ('operational', 'Operational Covenant'), ('reporting', 'Reporting Covenant'), ('negative', 'Negative Covenant'), ('affirmative', 'Affirmative Covenant')], max_length=30)),
                ('description', models.TextField(blank=True)),
                ('metric_name', models.CharField(blank=True, help_text='e.g., Debt/EBITDA', max_length=255)),
                ('threshold_value', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('threshold_type', models.CharField(choices=[('max', 'Maximum'), ('min', 'Minimum'), ('range', 'Range')], default='max', max_length=20)),
                ('current_value', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('status', models.CharField(choices=[('compliant', 'Compliant'), ('at_risk', 'At Risk'), ('breached', 'Breached'), ('waived', 'Waived')], default='compliant', max_length=20)),
                ('reporting_frequency', models.CharField(choices=[('monthly', 'Monthly'), ('quarterly', 'Quarterly'), ('semi_annual', 'Semi-Annual'), ('annual', 'Annual')], default='quarterly', max_length=20)),
                ('next_reporting_date', models.DateField(blank=True, null=True)),
                ('last_reported_date', models.DateField(blank=True, null=True)),
                ('source_clause', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pe_covenants', to='custom_authentication.client')),
                ('due_diligence_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='covenants', to='private_equity.duediligencerun')),
                ('source_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pe_covenant_sources', to='core.file')),
            ],
            options={
                'db_table': 'private_equity_covenant',
                'ordering': ['next_reporting_date', 'status'],
                'indexes': [models.Index(fields=['client', 'status'], name='private_equ_client__81f7f9_idx'), models.Index(fields=['next_reporting_date'], name='private_equ_next_re_3f59b4_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='panelfirm',
            index=models.Index(fields=['client', 'is_active'], name='private_equ_client__460fd6_idx'),
        ),
        migrations.AddIndex(
            model_name='rfp',
            index=models.Index(fields=['client', 'status'], name='private_equ_client__0c2236_idx'),
        ),
        migrations.AddIndex(
            model_name='rfp',
            index=models.Index(fields=['response_deadline'], name='private_equ_respons_44a137_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='rfpbid',
            unique_together={('rfp', 'firm')},
        ),
        migrations.AddIndex(
            model_name='signaturetracker',
            index=models.Index(fields=['client', 'due_diligence_run', 'status'], name='private_equ_client__7d09c0_idx'),
        ),
    ]
