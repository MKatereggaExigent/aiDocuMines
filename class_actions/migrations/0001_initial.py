# Generated by Django 5.2.9 on 2025-12-17 03:35

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('core', '0008_file_extension'),
        ('custom_authentication', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='MassClaimsRun',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('case_name', models.CharField(help_text='Name of the class action case', max_length=255)),
                ('case_number', models.CharField(help_text='Court case number', max_length=100)),
                ('court_jurisdiction', models.CharField(blank=True, help_text='Court jurisdiction', max_length=255)),
                ('case_type', models.CharField(choices=[('consumer_protection', 'Consumer Protection'), ('securities', 'Securities'), ('antitrust', 'Antitrust'), ('employment', 'Employment'), ('data_breach', 'Data Breach'), ('product_liability', 'Product Liability'), ('environmental', 'Environmental'), ('other', 'Other')], default='consumer_protection', max_length=100)),
                ('claim_deadline', models.DateTimeField(blank=True, help_text='Deadline for claim submissions', null=True)),
                ('settlement_amount', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('status', models.CharField(choices=[('intake', 'Intake Phase'), ('discovery', 'Discovery Phase'), ('settlement', 'Settlement Phase'), ('distribution', 'Distribution Phase'), ('closed', 'Closed')], default='intake', max_length=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_mass_claims_runs', to='custom_authentication.client')),
                ('run', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='mass_claims', to='core.run')),
            ],
            options={
                'db_table': 'class_actions_mass_claims_run',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='IntakeForm',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('claimant_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('claimant_data', models.JSONField(default=dict, help_text='Flexible claimant form data')),
                ('is_duplicate', models.BooleanField(default=False)),
                ('duplicate_score', models.FloatField(blank=True, help_text='Similarity score for duplicate detection', null=True)),
                ('processing_status', models.CharField(choices=[('pending', 'Pending Review'), ('processing', 'Processing'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('duplicate', 'Marked as Duplicate')], default='pending', max_length=50)),
                ('is_valid', models.BooleanField(default=True)),
                ('validation_errors', models.JSONField(blank=True, default=list)),
                ('submitted_at', models.DateTimeField(auto_now_add=True)),
                ('processed_at', models.DateTimeField(blank=True, null=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_intake_forms', to='custom_authentication.client')),
                ('duplicate_of', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='duplicates', to='class_actions.intakeform')),
                ('processed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ca_processed_forms', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_intake_forms', to=settings.AUTH_USER_MODEL)),
                ('mass_claims_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='intake_forms', to='class_actions.massclaimsrun')),
            ],
            options={
                'db_table': 'class_actions_intake_form',
                'ordering': ['-submitted_at'],
            },
        ),
        migrations.CreateModel(
            name='ExhibitPackage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('package_name', models.CharField(help_text='Name of the exhibit package', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Description of the package contents')),
                ('bates_prefix', models.CharField(default='EXHIBIT', help_text='Bates number prefix', max_length=20)),
                ('bates_start', models.CharField(help_text='Starting Bates number', max_length=50)),
                ('bates_end', models.CharField(help_text='Ending Bates number', max_length=50)),
                ('total_pages', models.IntegerField(default=0, help_text='Total pages in package')),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('processing', 'Processing'), ('ready', 'Ready for Production'), ('produced', 'Produced'), ('archived', 'Archived')], default='draft', max_length=50)),
                ('production_metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('produced_at', models.DateTimeField(blank=True, null=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_exhibit_packages', to='custom_authentication.client')),
                ('files', models.ManyToManyField(related_name='ca_exhibit_packages', to='core.file')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_exhibit_packages', to=settings.AUTH_USER_MODEL)),
                ('mass_claims_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='exhibit_packages', to='class_actions.massclaimsrun')),
            ],
            options={
                'db_table': 'class_actions_exhibit_package',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='EvidenceDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('evidence_type', models.CharField(choices=[('email', 'Email'), ('chat_log', 'Chat Log'), ('document', 'Document'), ('financial_record', 'Financial Record'), ('communication', 'Communication'), ('contract', 'Contract'), ('policy', 'Policy'), ('other', 'Other')], max_length=100)),
                ('is_culled', models.BooleanField(default=False, help_text='Whether document was culled (excluded)')),
                ('cull_reason', models.TextField(blank=True, help_text='Reason for culling')),
                ('relevance_score', models.FloatField(blank=True, help_text='AI-generated relevance score (0.0-1.0)', null=True)),
                ('contains_pii', models.BooleanField(default=False)),
                ('privilege_status', models.CharField(choices=[('none', 'No Privilege'), ('attorney_client', 'Attorney-Client'), ('work_product', 'Work Product'), ('other', 'Other Privilege')], default='none', max_length=50)),
                ('processing_metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_evidence_documents', to='custom_authentication.client')),
                ('file', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_evidence', to='core.file')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_evidence_documents', to=settings.AUTH_USER_MODEL)),
                ('mass_claims_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='evidence_documents', to='class_actions.massclaimsrun')),
            ],
            options={
                'db_table': 'class_actions_evidence_document',
                'ordering': ['-relevance_score', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ClaimantCommunication',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('communication_type', models.CharField(choices=[('email', 'Email'), ('mail', 'Physical Mail'), ('phone', 'Phone Call'), ('sms', 'SMS'), ('portal', 'Web Portal Message')], max_length=50)),
                ('subject', models.CharField(blank=True, max_length=255)),
                ('message_content', models.TextField()),
                ('sent_at', models.DateTimeField(auto_now_add=True)),
                ('delivered_at', models.DateTimeField(blank=True, null=True)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
                ('responded_at', models.DateTimeField(blank=True, null=True)),
                ('response_content', models.TextField(blank=True)),
                ('requires_follow_up', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_claimant_communications', to='custom_authentication.client')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_claimant_communications', to=settings.AUTH_USER_MODEL)),
                ('intake_form', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='communications', to='class_actions.intakeform')),
                ('mass_claims_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='claimant_communications', to='class_actions.massclaimsrun')),
            ],
            options={
                'db_table': 'class_actions_claimant_communication',
                'ordering': ['-sent_at'],
            },
        ),
        migrations.CreateModel(
            name='PIIRedaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('pii_type', models.CharField(choices=[('name', 'Personal Name'), ('email', 'Email Address'), ('phone', 'Phone Number'), ('ssn', 'Social Security Number'), ('address', 'Physical Address'), ('credit_card', 'Credit Card Number'), ('bank_account', 'Bank Account Number'), ('driver_license', 'Driver License'), ('passport', 'Passport Number'), ('other', 'Other PII')], max_length=50)),
                ('original_text', models.TextField(help_text='Original text containing PII')),
                ('redacted_text', models.TextField(help_text='Text with PII redacted')),
                ('page_number', models.IntegerField(help_text='Page number where PII was found')),
                ('position_start', models.IntegerField(blank=True, null=True)),
                ('position_end', models.IntegerField(blank=True, null=True)),
                ('confidence_score', models.FloatField(help_text='AI confidence in PII detection (0.0-1.0)')),
                ('is_verified', models.BooleanField(default=False, help_text='Human verification of redaction')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_pii_redactions', to='custom_authentication.client')),
                ('file', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_pii_redactions', to='core.file')),
                ('mass_claims_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pii_redactions', to='class_actions.massclaimsrun')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_pii_redactions', to=settings.AUTH_USER_MODEL)),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ca_verified_redactions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'class_actions_pii_redaction',
                'ordering': ['page_number', 'position_start'],
            },
        ),
        migrations.CreateModel(
            name='ServiceExecution',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('service_type', models.CharField(choices=[('ca-create-claims-run', 'Create Mass Claims Run'), ('ca-evidence-culling', 'Evidence Culling & Relevance'), ('ca-pii-redaction', 'PII Redaction & Privacy'), ('ca-duplicate-detection', 'Duplicate Detection'), ('ca-claims-dashboard', 'Claims Analysis Dashboard'), ('ca-mass-upload', 'Mass Document Upload'), ('ca-evidence-search', 'Evidence Document Search'), ('ca-document-qa', 'Evidence Q&A System'), ('ca-structure-analysis', 'Evidence Structure Analysis'), ('ca-file-management', 'Case File Management'), ('ca-client-summary', 'Case Statistics Summary'), ('ca-ocr-evidence', 'Evidence Document OCR')], max_length=50)),
                ('service_name', models.CharField(help_text='Human-readable service name', max_length=255)),
                ('service_version', models.CharField(default='1.0', max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('execution_time_seconds', models.IntegerField(blank=True, null=True)),
                ('input_parameters', models.JSONField(default=dict, help_text='Service input parameters')),
                ('output_type', models.CharField(choices=[('document', 'Document'), ('pdf', 'PDF'), ('text', 'Text'), ('json', 'JSON Data'), ('data', 'Data File'), ('analytics', 'Analytics'), ('report', 'Report'), ('chart', 'Chart'), ('dashboard', 'Dashboard'), ('excel', 'Excel'), ('matrix', 'Matrix'), ('package', 'Package')], default='json', max_length=20)),
                ('output_count', models.IntegerField(default=0, help_text='Number of output files generated')),
                ('error_message', models.TextField(blank=True)),
                ('error_traceback', models.TextField(blank=True)),
                ('execution_metadata', models.JSONField(default=dict, help_text='Additional execution metadata')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_service_executions', to='custom_authentication.client')),
                ('input_files', models.ManyToManyField(blank=True, related_name='ca_service_inputs', to='core.file')),
                ('mass_claims_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='service_executions', to='class_actions.massclaimsrun')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_service_executions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'class_actions_service_execution',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='ServiceOutput',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('output_name', models.CharField(help_text='Name/title of the output', max_length=255)),
                ('output_type', models.CharField(choices=[('document', 'Document'), ('pdf', 'PDF'), ('text', 'Text'), ('json', 'JSON Data'), ('data', 'Data File'), ('analytics', 'Analytics'), ('report', 'Report'), ('chart', 'Chart'), ('dashboard', 'Dashboard'), ('excel', 'Excel'), ('matrix', 'Matrix'), ('package', 'Package')], max_length=20)),
                ('file_extension', models.CharField(blank=True, help_text='File extension if applicable', max_length=10)),
                ('mime_type', models.CharField(blank=True, max_length=100)),
                ('output_file', models.FileField(blank=True, null=True, upload_to='ca_service_outputs/%Y/%m/%d/')),
                ('file_size', models.BigIntegerField(blank=True, help_text='File size in bytes', null=True)),
                ('output_data', models.JSONField(blank=True, help_text='Structured data output', null=True)),
                ('output_text', models.TextField(blank=True, help_text='Text-based output')),
                ('download_url', models.URLField(blank=True, help_text='Direct download URL')),
                ('preview_url', models.URLField(blank=True, help_text='Preview URL')),
                ('output_metadata', models.JSONField(default=dict, help_text='Additional output metadata')),
                ('is_primary', models.BooleanField(default=False, help_text='Primary output for the service')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_service_outputs', to='custom_authentication.client')),
                ('service_execution', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='outputs', to='class_actions.serviceexecution')),
            ],
            options={
                'db_table': 'class_actions_service_output',
                'ordering': ['-is_primary', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SettlementTracking',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('settlement_type', models.CharField(choices=[('monetary', 'Monetary Settlement'), ('injunctive', 'Injunctive Relief'), ('mixed', 'Mixed Settlement'), ('other', 'Other')], default='monetary', max_length=50)),
                ('total_settlement_amount', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('attorney_fees', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('administration_costs', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('net_settlement_fund', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('notice_type', models.CharField(choices=[('publication', 'Publication Notice'), ('direct_mail', 'Direct Mail'), ('email', 'Email Notice'), ('website', 'Website Notice'), ('combined', 'Combined Methods')], default='publication', max_length=50)),
                ('notice_deadline', models.DateTimeField(blank=True, null=True)),
                ('objection_deadline', models.DateTimeField(blank=True, null=True)),
                ('opt_out_deadline', models.DateTimeField(blank=True, null=True)),
                ('total_eligible_claimants', models.IntegerField(default=0)),
                ('total_approved_claims', models.IntegerField(default=0)),
                ('total_distributed_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('status', models.CharField(choices=[('pending_approval', 'Pending Court Approval'), ('approved', 'Court Approved'), ('notice_period', 'Notice Period'), ('distribution', 'Distribution Phase'), ('completed', 'Completed')], default='pending_approval', max_length=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('client', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_settlement_tracking', to='custom_authentication.client')),
                ('mass_claims_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='settlement_tracking', to='class_actions.massclaimsrun')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ca_settlement_tracking', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'class_actions_settlement_tracking',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='massclaimsrun',
            index=models.Index(fields=['client', '-created_at'], name='class_actio_client__b288d5_idx'),
        ),
        migrations.AddIndex(
            model_name='massclaimsrun',
            index=models.Index(fields=['client', 'case_name'], name='class_actio_client__589889_idx'),
        ),
        migrations.AddIndex(
            model_name='intakeform',
            index=models.Index(fields=['client', '-submitted_at'], name='class_actio_client__32ce41_idx'),
        ),
        migrations.AddIndex(
            model_name='intakeform',
            index=models.Index(fields=['client', 'processing_status'], name='class_actio_client__cb0545_idx'),
        ),
        migrations.AddIndex(
            model_name='exhibitpackage',
            index=models.Index(fields=['client', '-created_at'], name='class_actio_client__c8822b_idx'),
        ),
        migrations.AddIndex(
            model_name='exhibitpackage',
            index=models.Index(fields=['client', 'status'], name='class_actio_client__cec05b_idx'),
        ),
        migrations.AddIndex(
            model_name='evidencedocument',
            index=models.Index(fields=['client', '-relevance_score'], name='class_actio_client__dd1c05_idx'),
        ),
        migrations.AddIndex(
            model_name='evidencedocument',
            index=models.Index(fields=['client', 'evidence_type'], name='class_actio_client__c3fff7_idx'),
        ),
        migrations.AddIndex(
            model_name='claimantcommunication',
            index=models.Index(fields=['client', '-sent_at'], name='class_actio_client__8116b1_idx'),
        ),
        migrations.AddIndex(
            model_name='piiredaction',
            index=models.Index(fields=['client', 'pii_type'], name='class_actio_client__a349d1_idx'),
        ),
        migrations.AddIndex(
            model_name='serviceexecution',
            index=models.Index(fields=['client', '-started_at'], name='class_actio_client__1617fa_idx'),
        ),
        migrations.AddIndex(
            model_name='serviceexecution',
            index=models.Index(fields=['client', 'service_type'], name='class_actio_client__d6ed18_idx'),
        ),
        migrations.AddIndex(
            model_name='serviceexecution',
            index=models.Index(fields=['user', 'service_type'], name='class_actio_user_id_4a9eaa_idx'),
        ),
        migrations.AddIndex(
            model_name='serviceexecution',
            index=models.Index(fields=['mass_claims_run', 'status'], name='class_actio_mass_cl_ca3bdf_idx'),
        ),
        migrations.AddIndex(
            model_name='serviceexecution',
            index=models.Index(fields=['started_at'], name='class_actio_started_30eed3_idx'),
        ),
        migrations.AddIndex(
            model_name='serviceoutput',
            index=models.Index(fields=['client', '-created_at'], name='class_actio_client__63807b_idx'),
        ),
        migrations.AddIndex(
            model_name='serviceoutput',
            index=models.Index(fields=['service_execution', 'output_type'], name='class_actio_service_f597a1_idx'),
        ),
        migrations.AddIndex(
            model_name='serviceoutput',
            index=models.Index(fields=['created_at'], name='class_actio_created_70656e_idx'),
        ),
        migrations.AddIndex(
            model_name='settlementtracking',
            index=models.Index(fields=['client', '-created_at'], name='class_actio_client__3c84b2_idx'),
        ),
        migrations.AddIndex(
            model_name='settlementtracking',
            index=models.Index(fields=['client', 'status'], name='class_actio_client__8e8bc0_idx'),
        ),
    ]
