# Generated by Django 5.2.6 on 2025-10-03 20:27

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('core', '0008_file_extension'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='CommunicationMessage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('message_id', models.CharField(help_text='Unique message identifier from source system', max_length=255)),
                ('message_type', models.CharField(choices=[('email', 'Email'), ('slack', 'Slack Message'), ('teams', 'Microsoft Teams'), ('chat', 'Chat Message'), ('sms', 'SMS'), ('other', 'Other')], max_length=50)),
                ('sender', models.CharField(help_text='Message sender', max_length=255)),
                ('recipients', models.JSONField(default=list, help_text='List of message recipients')),
                ('subject', models.CharField(blank=True, help_text='Message subject (for emails)', max_length=500)),
                ('content', models.TextField(help_text='Message content/body')),
                ('sent_datetime', models.DateTimeField(help_text='When the message was sent')),
                ('sentiment_score', models.FloatField(blank=True, help_text='Sentiment analysis score (-1.0 to 1.0)', null=True)),
                ('toxicity_score', models.FloatField(blank=True, help_text='Toxicity score (0.0 to 1.0)', null=True)),
                ('relevance_score', models.FloatField(blank=True, help_text='Relevance to case (0.0 to 1.0)', null=True)),
                ('is_privileged', models.BooleanField(default=False)),
                ('contains_pii', models.BooleanField(default=False)),
                ('is_flagged', models.BooleanField(default=False, help_text='Flagged for review')),
                ('flag_reason', models.TextField(blank=True, help_text='Reason for flagging')),
                ('processing_metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('file', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='le_communication_messages', to='core.file')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='le_communication_messages', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'labor_employment_communication_message',
                'ordering': ['-sent_datetime'],
            },
        ),
        migrations.CreateModel(
            name='WorkplaceCommunicationsRun',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('case_name', models.CharField(help_text='Name of the employment case', max_length=255)),
                ('company_name', models.CharField(help_text='Company being analyzed', max_length=255)),
                ('case_type', models.CharField(choices=[('discrimination', 'Discrimination'), ('harassment', 'Harassment'), ('wrongful_termination', 'Wrongful Termination'), ('wage_hour', 'Wage and Hour'), ('retaliation', 'Retaliation'), ('whistleblower', 'Whistleblower'), ('policy_violation', 'Policy Violation'), ('other', 'Other')], default='discrimination', max_length=100)),
                ('data_sources', models.JSONField(default=list, help_text='List of data sources (O365, Slack, Teams, etc.)')),
                ('analysis_start_date', models.DateTimeField(help_text='Start date for communications analysis')),
                ('analysis_end_date', models.DateTimeField(help_text='End date for communications analysis')),
                ('key_personnel', models.JSONField(default=list, help_text='List of key personnel involved in the case')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('run', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='workplace_communications', to='core.run')),
            ],
            options={
                'db_table': 'labor_employment_communications_run',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='PolicyComparison',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('policy_name', models.CharField(help_text='Name of the policy being analyzed', max_length=255)),
                ('policy_type', models.CharField(choices=[('harassment', 'Harassment Policy'), ('discrimination', 'Discrimination Policy'), ('code_of_conduct', 'Code of Conduct'), ('social_media', 'Social Media Policy'), ('communication', 'Communication Policy'), ('remote_work', 'Remote Work Policy'), ('overtime', 'Overtime Policy'), ('other', 'Other Policy')], max_length=100)),
                ('policy_text', models.TextField(help_text='Extracted policy text')),
                ('compliance_score', models.FloatField(help_text='Compliance score (0.0 to 1.0)')),
                ('violations_found', models.JSONField(default=list, help_text='List of policy violations found in communications')),
                ('recommendations', models.JSONField(default=list, help_text='Policy improvement recommendations')),
                ('best_practices_score', models.FloatField(blank=True, help_text='Score against industry best practices', null=True)),
                ('missing_elements', models.JSONField(default=list, help_text='Missing policy elements')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('policy_document', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='le_policy_comparisons', to='core.file')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='le_policy_comparisons', to=settings.AUTH_USER_MODEL)),
                ('communications_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='policy_comparisons', to='labor_employment.workplacecommunicationsrun')),
            ],
            options={
                'db_table': 'labor_employment_policy_comparison',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='EEOCPacket',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('packet_name', models.CharField(help_text='Name of the EEOC packet', max_length=255)),
                ('complainant_name', models.CharField(max_length=255)),
                ('complainant_title', models.CharField(blank=True, max_length=255)),
                ('complainant_department', models.CharField(blank=True, max_length=255)),
                ('complaint_type', models.CharField(choices=[('race', 'Race Discrimination'), ('gender', 'Gender Discrimination'), ('age', 'Age Discrimination'), ('disability', 'Disability Discrimination'), ('religion', 'Religious Discrimination'), ('national_origin', 'National Origin Discrimination'), ('sexual_harassment', 'Sexual Harassment'), ('retaliation', 'Retaliation'), ('other', 'Other')], max_length=100)),
                ('incident_date', models.DateField(help_text='Date of the alleged incident')),
                ('complaint_summary', models.TextField(help_text='Summary of the complaint')),
                ('evidence_strength_score', models.FloatField(blank=True, help_text='Strength of evidence (0.0 to 1.0)', null=True)),
                ('timeline_analysis', models.JSONField(default=dict, help_text='Timeline of relevant events')),
                ('key_findings', models.JSONField(default=list, help_text='Key findings from analysis')),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('review', 'Under Review'), ('ready', 'Ready for Submission'), ('submitted', 'Submitted'), ('closed', 'Closed')], default='draft', max_length=50)),
                ('generation_metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('submitted_at', models.DateTimeField(blank=True, null=True)),
                ('relevant_messages', models.ManyToManyField(related_name='eeoc_packets', to='labor_employment.communicationmessage')),
                ('supporting_documents', models.ManyToManyField(related_name='le_eeoc_packets', to='core.file')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='le_eeoc_packets', to=settings.AUTH_USER_MODEL)),
                ('communications_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='eeoc_packets', to='labor_employment.workplacecommunicationsrun')),
            ],
            options={
                'db_table': 'labor_employment_eeoc_packet',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ComplianceAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('alert_type', models.CharField(choices=[('harassment_language', 'Harassment Language Detected'), ('discriminatory_language', 'Discriminatory Language'), ('policy_violation', 'Policy Violation'), ('overtime_indication', 'Overtime Work Indication'), ('retaliation_risk', 'Potential Retaliation'), ('hostile_environment', 'Hostile Work Environment'), ('other', 'Other Compliance Issue')], max_length=100)),
                ('alert_title', models.CharField(max_length=255)),
                ('alert_description', models.TextField()),
                ('severity', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], max_length=20)),
                ('priority', models.CharField(choices=[('low', 'Low Priority'), ('medium', 'Medium Priority'), ('high', 'High Priority'), ('urgent', 'Urgent')], max_length=20)),
                ('status', models.CharField(choices=[('open', 'Open'), ('investigating', 'Under Investigation'), ('resolved', 'Resolved'), ('false_positive', 'False Positive'), ('dismissed', 'Dismissed')], default='open', max_length=50)),
                ('resolution_notes', models.TextField(blank=True)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('related_messages', models.ManyToManyField(related_name='compliance_alerts', to='labor_employment.communicationmessage')),
                ('resolved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='le_resolved_alerts', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='le_compliance_alerts', to=settings.AUTH_USER_MODEL)),
                ('communications_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='compliance_alerts', to='labor_employment.workplacecommunicationsrun')),
            ],
            options={
                'db_table': 'labor_employment_compliance_alert',
                'ordering': ['-severity', '-priority', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CommunicationPattern',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('pattern_type', models.CharField(choices=[('exclusion', 'Communication Exclusion'), ('timing', 'Unusual Timing Patterns'), ('sentiment_shift', 'Sentiment Shift'), ('volume_change', 'Communication Volume Change'), ('language_pattern', 'Language Pattern'), ('network_isolation', 'Network Isolation'), ('other', 'Other Pattern')], max_length=100)),
                ('pattern_name', models.CharField(help_text='Descriptive name for the pattern', max_length=255)),
                ('description', models.TextField(help_text='Detailed description of the pattern')),
                ('involved_personnel', models.JSONField(default=list, help_text='Personnel involved in the pattern')),
                ('confidence_score', models.FloatField(help_text='Confidence in pattern detection (0.0 to 1.0)')),
                ('severity_score', models.FloatField(help_text='Severity of the pattern (0.0 to 1.0)')),
                ('pattern_start_date', models.DateTimeField()),
                ('pattern_end_date', models.DateTimeField()),
                ('pattern_details', models.JSONField(default=dict, help_text='Detailed pattern analysis')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('supporting_messages', models.ManyToManyField(related_name='communication_patterns', to='labor_employment.communicationmessage')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='le_communication_patterns', to=settings.AUTH_USER_MODEL)),
                ('communications_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='communication_patterns', to='labor_employment.workplacecommunicationsrun')),
            ],
            options={
                'db_table': 'labor_employment_communication_pattern',
                'ordering': ['-severity_score', '-confidence_score'],
            },
        ),
        migrations.AddField(
            model_name='communicationmessage',
            name='communications_run',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages', to='labor_employment.workplacecommunicationsrun'),
        ),
        migrations.CreateModel(
            name='WageHourAnalysis',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('employee_name', models.CharField(max_length=255)),
                ('employee_id', models.CharField(blank=True, max_length=100)),
                ('job_title', models.CharField(blank=True, max_length=255)),
                ('department', models.CharField(blank=True, max_length=255)),
                ('analysis_start_date', models.DateField()),
                ('analysis_end_date', models.DateField()),
                ('total_hours_worked', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('regular_hours', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('overtime_hours', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('early_morning_messages', models.IntegerField(default=0, help_text='Messages sent before 7 AM')),
                ('late_evening_messages', models.IntegerField(default=0, help_text='Messages sent after 7 PM')),
                ('weekend_messages', models.IntegerField(default=0, help_text='Messages sent on weekends')),
                ('hourly_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('regular_pay', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('overtime_pay', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('total_pay', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('potential_overtime_violations', models.BooleanField(default=False)),
                ('potential_break_violations', models.BooleanField(default=False)),
                ('potential_meal_violations', models.BooleanField(default=False)),
                ('analysis_metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='le_wage_hour_analyses', to=settings.AUTH_USER_MODEL)),
                ('communications_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='wage_hour_analyses', to='labor_employment.workplacecommunicationsrun')),
            ],
            options={
                'db_table': 'labor_employment_wage_hour_analysis',
                'ordering': ['-created_at'],
                'unique_together': {('employee_name', 'communications_run', 'analysis_start_date')},
            },
        ),
        migrations.AlterUniqueTogether(
            name='communicationmessage',
            unique_together={('message_id', 'communications_run')},
        ),
    ]
